# Branch

## Why combine Branch and Purchasely?

### Pre-requisites

The minimal version of the Purchasely SDK supporting this integration is //TODO: Kevin. If the Purchasely SDK integrated in your app is under the minimal version, please update it.

The Branch SDK also needs to be integrated inside the app.

### Subscription events

### General overview

[Branch](https://branch.io) allow their customer to acquire, engage, and measure across all devices, channels, and platforms.

This integration will allow you to get all the available Purchasely events to Branch and get a better and deeper understanding of your subscription business and customer behavior.

Purchasely provides a unified dataset to track the subscription events for all stores. These events are generated by the Purchasely Backend and can be sent to Branch.

![](<../.gitbook/assets/image (143).png>)

Subscription events generated by Purchasely will be sent to Branch using a server-to-server integration. As a result, you will be able to see all the subscription events in your Branch Dashboard and map them with your acquisition campaigns.

#### Events

The following events are the main ones that can be sent to Branch by Purchasely. See the full list [here](../analytics/events/webhook-events/subscription-events.md).

| Event                           | Description                                                                                                              |
| ------------------------------- | ------------------------------------------------------------------------------------------------------------------------ |
| SUBSCRIPTION\_STARTED           | Sent when the user purchased a product wether it is the start of a trial or a regular purchase of a consumable product.  |
| SUBSCRIPTION\_RENEWED           | Sent when a subscription renews                                                                                          |
| SUBSCRIPTION\_EXPIRED           | Sent when the subscription actually ends                                                                                 |
| SUBSCRIPTION\_REACTIVATED       | Sent when an expired subscription is reactivated. This event is particularly useful for win-back & retargeting campaigns |
| SUBSCRIPTION\_REFUNDED\_REVOKED | Sent when the subscription actually ends                                                                                 |
| RENEWAL\_DISABLED               | Sent when the user deactivates the renewal of a subscription wether it is in trial period or not.                        |
| RENEWAL\_ENABLED                | Sent when the user reactivates                                                                                           |
| TRIAL\_STARTED                  | Sent when a trial starts                                                                                                 |
| TRIAL\_CONVERTED                | Sent when a user converts from a free trial to a normal paid-period                                                      |
| TRIAL\_NOT\_CONVERTED           | Sent when a user finishes it's trial period without renewing to a paid-period                                            |

The names of events sent to Branch can be overriden when setting up the integration.

## **Integrating Purchasely with Branch**

The integration requires ${integration\_setup\_steps\_count} steps:

1. Associate the user to events by providing the Purchasely SDK with the customer user id provided to the Branch SDK
2. Activate the Branch integration in the Purchasely Console

### 1. Associating users to events

See the [Branch Documentation](https://help.branch.io/developers-hub/docs/custom-settings#settings-for-user-ids) for more information



### 2. Activating the Branch integration

The activation requires 3 steps:

1. Retrieving your Branch API Key from Branch's dashboard
2. Retrieving your Branch API Secret integration's dashboard
3. Enabling the Branch integration in the Purchasely Console

#### a. Retrieve your Branch API Key from Branch's dashboard

1. Follow [the Branch documentation](https://help.branch.io/using-branch/docs/profile-settings#branch-key-and-secret)
2. Write down your API Key

#### b. Retrieve your Branch API Secret Branch's dashboard

1. Follow [the Branch documentation](https://help.branch.io/using-branch/docs/profile-settings#branch-key-and-secret)
2. Write down your API Secret

#### c. Enabling the Branch integration in the Purchasely Console

1. Go in the "External integrations" section, and open the edition form for Branch:

![](<../.gitbook/assets/Screenshot 2022-11-06 at 19.41.52.png>)

2\. Enable the integration

3\. Set your Branch API Key

4\. Set your Branch API Secret

![](<../.gitbook/assets/Screenshot 2022-11-06 at 19.42.07.png>)

6\. Enable the events you want to be sent to Branch

7\. (Optional) Override the names of the events that will be sent to Branch

![](<../.gitbook/assets/Screenshot 2022-11-06 at 19.42.49.png>)

8\. Save

### Testing your integration

To test your integration, you can perform a set of in-app purchases in a Sandbox environment (eg: TestFlight for the App Store) and verify your events are received in the Branch dashboard [https://dashboard.branch.io](https://dashboard.branch.io).
